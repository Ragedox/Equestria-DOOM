actor Broom : Weapon 90
{
  Weapon.SelectionOrder 3600
  Weapon.SlotNumber 1
  Height 40
  Inventory.PickupMessage "Let's clean up some Demons!"
  +WEAPON.NOAUTOFIRE
  Weapon.BobStyle alpha
	//$Category "Weapons"
  States
  {
  Spawn:
	BROM A -1
    Stop
  Ready:
	TNT1 A 0 A_JumpIfInventory("KickCheck", 1, "KickAttack")
		
	BROO A 1 A_WeaponReady
	Loop
	
	Deselect:
		TNT1 A 0 A_TakeInventory("KickCheck", 999)
		
		BROO A 1 A_Lower
		Wait
  
  Select:
	TNT1 A 0 A_TakeInventory("KickCheck", 999)
	
    BROO A 0 A_SetCrosshair(8)
	BROO A 1 A_Raise
	Loop
  Fire:
	BROO BC 3
	BROO D 4
	BROO E 2 A_FireProjectile("BroomProjectile")
	TNT1 A 1 A_TakeInventory("Broom")
	Goto Deselect
	
	KickAttack:
		TNT1 A 0 A_OverlayFlags(0, PSPF_INTERPOLATE, true)
		
		TNT1 A 0 A_TakeInventory("KickCheck", 999)
		
		TNT1 A 0 A_JumpIf(momZ > 0, "AirKick")
		TNT1 A 0 A_JumpIf(momZ < 0, "AirKick")
        TNT1 A 0 A_JumpIfInventory("PowerStrength", 1, "BerserkerKick")
				
		TNT1 A 0 SetPlayerProperty(0, 1, PROP_FROZEN)
		
		TNT1 A 0 A_StartSound("skeleton/swing")
		TNT1 A 0 A_AlertMonsters (500, 0)
		KICK BCD 1
		TNT1 A 0 A_CustomPunch(2 * Random(1,10), true, 0, "KickPuff", 75, 0, 0, "BasicArmorBonus", "*fist")
		KICK H 2
		TNT1 A 0 SetPlayerProperty(0, 0, 0)
		KICK IGFEDCB 2
		
		TNT1 A 0 A_OverlayFlags(0, PSPF_INTERPOLATE, false)
		
		TNT1 A 0 A_TakeInventory("KickCheck", 999)
		Goto Ready
		
	BerserkerKick:
		TNT1 A 0 A_OverlayFlags(0, PSPF_INTERPOLATE, true)
		
		TNT1 A 0 A_TakeInventory("KickCheck", 999)
		
		TNT1 A 0 A_StartSound("skeleton/swing")
		TNT1 A 0 A_AlertMonsters (500, 0)
		KICK BCD 1
        TNT1 A 0 A_CustomPunch(20 * Random(1, 10), TRUE, 0, "BerserkPuff", 75, 0, 0, "BasicArmorBonus", "skeleton/melee")
        KICK H 2
		KICK IGFEDCB 2
		
		TNT1 A 0 A_OverlayFlags(0, PSPF_INTERPOLATE, false)
		
		TNT1 A 0 A_TakeInventory("KickCheck", 999)
		Goto Ready
		
	AirKick:
		TNT1 A 0 A_OverlayFlags(0, PSPF_INTERPOLATE, true)
		
		TNT1 A 0 A_TakeInventory("KickCheck", 999)
	   
		TNT1 A 0 A_JumpIfInventory("PowerStrength", 1, "BerserkAirKick")
		
		TNT1 A 0 SetPlayerProperty(0, 1, PROP_FROZEN)
		
		TNT1 A 0 A_StartSound("skeleton/swing")
		TNT1 A 0 A_Recoil(-6)
		KICK JKLMN 1
        TNT1 A 0 A_CustomPunch(2*Random(1,10), true, 0, "KickPuff", 75, 0, 0, "BasicArmorBonus", "*fist")
        KICK O 2 A_AlertMonsters (500, 0)
		KICK PQRST 2
		
		TNT1 A 0 A_OverlayFlags(0, PSPF_INTERPOLATE, false)
		
		TNT1 A 0 SetPlayerProperty(0, 0, 0)
		
		TNT1 A 0 A_TakeInventory("KickCheck", 999)
		Goto Ready
		
	BerserkAirKick:
		TNT1 A 0 A_OverlayFlags(0, PSPF_INTERPOLATE, true)
		
		TNT1 A 0 A_TakeInventory("KickCheck", 999)
		
		TNT1 A 0 A_StartSound("skeleton/swing")
		TNT1 A 0 A_Recoil(-6)
		KICK JKLMN 1
        TNT1 A 0 A_CustomPunch(20 * Random(1, 10), TRUE, 0, "BerserkPuff", 75, 0, 0, "BasicArmorBonus", "skeleton/melee")
        KICK O 2 A_AlertMonsters (500, 0)
		KICK PQRST 2
		
		TNT1 A 0 A_OverlayFlags(0, PSPF_INTERPOLATE, false)
		
		TNT1 A 0 A_TakeInventory("KickCheck", 999)
		Goto Ready
  }
}

actor BroomProjectile
{
	PROJECTILE
	+NOEXTREMEDEATH
	+FORCEXYBILLBOARD
	-NOGRAVITY
	-NOICEDEATH
	
	ProjectileKickBack 100
	Radius 10
	Height 20
	Speed 40
	Damage 8
	States
	{
	Spawn:
		//TNT1 A 0 A_SpawnItemEx ("BroomMotion", 0, 0, 0)
		BROM BCDC 2
		Loop
	Death:
		BBRK ABCDE 1 A_NoBlocking
		BBRK FGHIJ 1 A_UnSetShootable
		BBRK K -1 A_SetFloorClip
		Stop
	}
}


/*actor BroomMotion
{
  PROJECTILE
  +NOEXTREMEDEATH
  +FORCEXYBILLBOARD
  -NOGRAVITY
  Radius 0
  Height 0
  Speed 35
  RenderStyle Translucent
  alpha 0.5
  States
  {
  Spawn:
	BROP ABCDEFGHIJ 1
	Loop
  Death:
    BBRK ABCDE 1 A_NoBlocking
	BBRK FGHIJ 1 A_UnSetShootable
	Stop
  }
}*/